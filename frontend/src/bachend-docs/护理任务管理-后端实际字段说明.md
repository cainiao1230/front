# æŠ¤ç†ä»»åŠ¡ç®¡ç† - åç«¯å®é™…å­—æ®µè¯´æ˜ï¼ˆè¯·å‰ç«¯è°ƒæ•´ï¼‰

## ğŸ“Œ é‡è¦è¯´æ˜
åç«¯å·²å®ç°çš„å­—æ®µä¸å‰ç«¯éœ€æ±‚æ–‡æ¡£æœ‰å·®å¼‚ï¼Œå› æ¶‰åŠæ•°æ®åº“è®¾è®¡ï¼Œå»ºè®®å‰ç«¯æŒ‰ç…§åç«¯å®é™…å­—æ®µè¿›è¡Œè°ƒæ•´ã€‚

---

## âœ… åç«¯å·²å®ç°çš„æ¥å£

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | çŠ¶æ€ |
|------|------|------|------|
| åˆ›å»ºä»»åŠ¡ | POST | /api/care/tasks | âœ… å·²å®ç° |
| ä»»åŠ¡åˆ—è¡¨ | GET | /api/care/tasks | âœ… å·²å®ç° |
| ä»»åŠ¡è¯¦æƒ… | GET | /api/care/tasks/{id} | âœ… å·²å®ç° |
| æ›´æ–°ä»»åŠ¡ | PUT | /api/care/tasks/{id} | âœ… å·²å®ç° |
| åˆ é™¤ä»»åŠ¡ | DELETE | /api/care/tasks/{id} | âœ… å·²å®ç° |
| æ›´æ–°çŠ¶æ€ | PATCH | /api/care/tasks/{id}/status | âœ… å·²å®ç° |
| ä»Šæ—¥ä»»åŠ¡ | GET | /api/care/tasks/today | âœ… å·²å®ç° |

---

## ğŸ” åç«¯å®é™…å­—æ®µå¯¹ç…§è¡¨

### CareTask æ•°æ®ç»“æ„ï¼ˆåç«¯å®é™…ï¼‰

```json
{
  "id": 1,
  "elderly_id": 1,              // âœ… æœ‰
  "elderly_name": "æçˆ·çˆ·",       // âœ… æœ‰ï¼ˆæŸ¥è¯¢æ—¶å…³è”ï¼‰
  "title": "ååŠ©åˆé¤",           // âœ… æœ‰ï¼ˆä»»åŠ¡æ ‡é¢˜ï¼‰
  "description": "ååŠ©è€äººè¿›é£Ÿ...", // âœ… æœ‰ï¼ˆä»»åŠ¡è¯¦ç»†æè¿°ï¼‰
  "priority": "high",            // âœ… æœ‰ï¼ˆlow/medium/highï¼‰
  "status": "pending",           // âœ… æœ‰ï¼ˆpending/in_progress/completed/cancelledï¼‰
  "assigned_to": 5,              // âœ… æœ‰ï¼ˆåˆ†é…ç»™çš„æŠ¤å·¥IDï¼‰
  "assigned_to_name": "å¼ æŠ¤å·¥",   // âœ… æœ‰ï¼ˆæŸ¥è¯¢æ—¶å…³è”ï¼‰
  "scheduled_time": "2026-01-20T12:00:00", // âœ… æœ‰
  "completed_at": "2026-01-20T13:00:00",   // âœ… æœ‰
  "created_at": "2026-01-20T10:00:00",     // âœ… æœ‰
  "updated_at": "2026-01-20T10:00:00"      // âœ… æœ‰
}
```

### âš ï¸ å‰ç«¯éœ€æ±‚æ–‡æ¡£ä¸­çš„å­—æ®µå¯¹æ¯”

| å‰ç«¯å­—æ®µ | åç«¯å­—æ®µ | çŠ¶æ€ | è¯´æ˜ |
|---------|---------|------|------|
| elderly_id | elderly_id | âœ… ä¸€è‡´ | è€äººID |
| elderly_name | elderly_name | âœ… ä¸€è‡´ | è€äººå§“å |
| task_type | âŒ æ—  | âš ï¸ ç¼ºå¤± | å‰ç«¯è¦æ±‚çš„ä»»åŠ¡ç±»å‹å­—æ®µï¼ˆfeeding/bathingç­‰ï¼‰|
| task_content | description | âš ï¸ ä¸åŒ | åç«¯ç”¨ `description` å­—æ®µ |
| priority | priority | âœ… ä¸€è‡´ | ä¼˜å…ˆçº§ |
| status | status | âœ… ä¸€è‡´ | ä»»åŠ¡çŠ¶æ€ |
| assigned_to | assigned_to | âœ… ä¸€è‡´ | åˆ†é…ç»™çš„æŠ¤å·¥ID |
| caregiver_name | assigned_to_name | âš ï¸ ä¸åŒ | åç«¯ç”¨ `assigned_to_name` |
| scheduled_time | scheduled_time | âœ… ä¸€è‡´ | è®¡åˆ’æ‰§è¡Œæ—¶é—´ |
| started_at | âŒ æ—  | âš ï¸ ç¼ºå¤± | åç«¯æš‚æ— æ­¤å­—æ®µ |
| completed_at | completed_at | âœ… ä¸€è‡´ | å®Œæˆæ—¶é—´ |
| room_number | âŒ æ—  | âš ï¸ ç¼ºå¤± | åç«¯æš‚æ— æˆ¿é—´å·å­—æ®µ |
| notes | âŒ æ—  | âš ï¸ ç¼ºå¤± | åç«¯æš‚æ— å¤‡æ³¨å­—æ®µ |

---

## ğŸ“ å»ºè®®å‰ç«¯è°ƒæ•´æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šå­—æ®µåæ˜ å°„ï¼ˆæ¨èï¼‰

å‰ç«¯åœ¨è°ƒç”¨æ¥å£æ—¶è¿›è¡Œå­—æ®µæ˜ å°„ï¼š

```javascript
// å‰ç«¯æäº¤æ•°æ®æ—¶
const submitData = {
  elderly_id: form.elderly_id,
  title: form.task_type,           // å°†task_typeä½œä¸ºtitle
  description: form.task_content,   // å°†task_contentæ˜ å°„ä¸ºdescription
  priority: form.priority,
  assigned_to: form.assigned_to,
  scheduled_time: form.scheduled_time
};

// å‰ç«¯æ¥æ”¶æ•°æ®æ—¶
const displayData = {
  ...taskData,
  task_type: taskData.title,          // å°†titleæ˜ å°„ä¸ºtask_type
  task_content: taskData.description,  // å°†descriptionæ˜ å°„ä¸ºtask_content
  caregiver_name: taskData.assigned_to_name // å°†assigned_to_nameæ˜ å°„ä¸ºcaregiver_name
};
```

### æ–¹æ¡ˆ2ï¼šç›´æ¥ä½¿ç”¨åç«¯å­—æ®µï¼ˆæœ€ç®€å•ï¼‰

å‰ç«¯ç›´æ¥ä½¿ç”¨åç«¯å­—æ®µåï¼Œæ— éœ€æ˜ å°„ï¼š
- ä½¿ç”¨ `title` æ›¿ä»£ `task_type`
- ä½¿ç”¨ `description` æ›¿ä»£ `task_content`
- ä½¿ç”¨ `assigned_to_name` æ›¿ä»£ `caregiver_name`

---

## ğŸ”§ æ¥å£è¯¦ç»†è¯´æ˜

### 1. åˆ›å»ºä»»åŠ¡ POST /api/care/tasks

**è¯·æ±‚å‚æ•°ï¼ˆåç«¯å®é™…æ¥å—çš„å­—æ®µï¼‰ï¼š**
```json
{
  "elderly_id": 1,              // å¿…å¡«
  "title": "ååŠ©åˆé¤",          // å¿…å¡«ï¼ˆä»»åŠ¡æ ‡é¢˜ï¼‰
  "description": "ååŠ©è€äººè¿›é£Ÿï¼Œæ³¨æ„å’€åš¼", // å¯é€‰ï¼ˆè¯¦ç»†æè¿°ï¼‰
  "priority": "high",           // å¿…å¡«ï¼ˆlow/medium/highï¼‰
  "assigned_to": 5,             // å¿…å¡«ï¼ˆæŠ¤å·¥IDï¼‰
  "scheduled_time": "2026-01-20T12:00:00" // å¿…å¡«
}
```

**å“åº”æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": "ok",
  "data": {
    "id": 11,
    "elderly_id": 1,
    "elderly_name": "æçˆ·çˆ·",
    "title": "ååŠ©åˆé¤",
    "description": "ååŠ©è€äººè¿›é£Ÿï¼Œæ³¨æ„å’€åš¼",
    "priority": "high",
    "status": "pending",
    "assigned_to": 5,
    "assigned_to_name": "å¼ æŠ¤å·¥",
    "scheduled_time": "2026-01-20T12:00:00",
    "completed_at": null,
    "created_at": "2026-01-20T10:30:00",
    "updated_at": "2026-01-20T10:30:00"
  }
}
```

---

### 2. ä»»åŠ¡åˆ—è¡¨ GET /api/care/tasks

**æŸ¥è¯¢å‚æ•°ï¼š**
- `elderly_id` - è€äººIDï¼ˆå¯é€‰ï¼‰
- `status` - ä»»åŠ¡çŠ¶æ€ï¼špending/in_progress/completed/cancelledï¼ˆå¯é€‰ï¼‰
- `assigned_to` - æŠ¤å·¥IDï¼ˆå¯é€‰ï¼‰
- `page` - é¡µç ï¼ˆé»˜è®¤1ï¼‰
- `page_size` - æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤10ï¼‰

**æ³¨æ„ï¼š** âš ï¸ åç«¯ä¸æ”¯æŒ `priority` å‚æ•°è¿‡æ»¤

**å“åº”æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": "ok",
  "data": {
    "items": [
      {
        "id": 1,
        "elderly_id": 1,
        "elderly_name": "æçˆ·çˆ·",
        "title": "ååŠ©åˆé¤",
        "description": "ååŠ©è€äººè¿›é£Ÿ",
        "priority": "high",
        "status": "pending",
        "assigned_to": 5,
        "assigned_to_name": "å¼ æŠ¤å·¥",
        "scheduled_time": "2026-01-20T12:00:00",
        "completed_at": null,
        "created_at": "2026-01-20T10:00:00",
        "updated_at": "2026-01-20T10:00:00"
      }
    ],
    "total": 10,
    "page": 1,
    "page_size": 10
  }
}
```

---

### 3. ä»Šæ—¥ä»»åŠ¡ GET /api/care/tasks/today

**è¯´æ˜ï¼š** è¿”å›å½“å‰ç™»å½•ç”¨æˆ·ä»Šå¤©çš„æ‰€æœ‰ä»»åŠ¡ï¼ˆè‡ªåŠ¨è¿‡æ»¤å½“å‰ç”¨æˆ·ï¼‰

**å“åº”æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": "ok",
  "data": {
    "items": [
      {
        "id": 1,
        "elderly_id": 1,
        "elderly_name": "æçˆ·çˆ·",
        "title": "ååŠ©åˆé¤",
        "description": "ååŠ©è€äººè¿›é£Ÿ",
        "priority": "high",
        "status": "pending",
        "assigned_to": 5,
        "assigned_to_name": "å¼ æŠ¤å·¥",
        "scheduled_time": "2026-01-20T12:00:00",
        "completed_at": null,
        "created_at": "2026-01-20T10:00:00",
        "updated_at": "2026-01-20T10:00:00"
      }
    ],
    "total": 5
  }
}
```

---

### 4. æ›´æ–°ä»»åŠ¡çŠ¶æ€ PATCH /api/care/tasks/{id}/status

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "status": "in_progress"  // pending/in_progress/completed/cancelled
}
```

**å“åº”æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": "ok",
  "data": {
    "id": 1,
    "status": "completed",
    "completed_at": "2026-01-20T13:00:00"  // å®Œæˆæ—¶è‡ªåŠ¨è®°å½•
  }
}
```

**çŠ¶æ€æµè½¬è§„åˆ™ï¼š**
- `pending` â†’ `in_progress` æˆ– `cancelled`
- `in_progress` â†’ `completed` æˆ– `cancelled`
- `completed` å’Œ `cancelled` ä¸èƒ½å†æ”¹å˜

---

### 5. æ›´æ–°ä»»åŠ¡ PUT /api/care/tasks/{id}

**è¯·æ±‚å‚æ•°ï¼ˆæ‰€æœ‰å­—æ®µå¯é€‰ï¼‰ï¼š**
```json
{
  "elderly_id": 1,
  "title": "ååŠ©æ™šé¤",
  "description": "ååŠ©è€äººæ™šé¤è¿›é£Ÿ",
  "priority": "medium",
  "assigned_to": 6,
  "scheduled_time": "2026-01-20T18:00:00"
}
```

---

### 6. åˆ é™¤ä»»åŠ¡ DELETE /api/care/tasks/{id}

**å“åº”æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": "ok",
  "data": null
}
```

---

## ğŸš« åç«¯æš‚ä¸æ”¯æŒçš„åŠŸèƒ½

### 1. ä»»åŠ¡ç±»å‹æšä¸¾ï¼ˆtask_typeï¼‰
**å‰ç«¯éœ€æ±‚ï¼š** feeding/bathing/turning/companionship/rehabilitation/health_check/other

**åç«¯ç°çŠ¶ï¼š** æ²¡æœ‰ä¸“é—¨çš„ `task_type` å­—æ®µï¼Œä½¿ç”¨ `title` å’Œ `description` è‡ªç”±è¾“å…¥

**å»ºè®®ï¼š** 
- å‰ç«¯å¯ä»¥åœ¨ä¸‹æ‹‰æ¡†é€‰æ‹©ä»»åŠ¡ç±»å‹ï¼Œä½†æäº¤æ—¶æ”¾å…¥ `title` å­—æ®µ
- æˆ–è€…åœ¨ `title` ä¸­åŠ å…¥ç±»å‹å‰ç¼€ï¼Œå¦‚ "ã€å–‚é¥­ã€‘ååŠ©åˆé¤"

### 2. å¼€å§‹æ—¶é—´ï¼ˆstarted_atï¼‰
**å‰ç«¯éœ€æ±‚ï¼š** è®°å½•ä»»åŠ¡å¼€å§‹æ—¶é—´

**åç«¯ç°çŠ¶ï¼š** æš‚æ— æ­¤å­—æ®µï¼Œåªæœ‰ `completed_at`

**å»ºè®®ï¼š** 
- æš‚æ—¶ä¸æ˜¾ç¤ºå¼€å§‹æ—¶é—´
- æˆ–è€…å‰ç«¯æœ¬åœ°è®°å½•

### 3. æˆ¿é—´å·ï¼ˆroom_numberï¼‰
**å‰ç«¯éœ€æ±‚ï¼š** æ˜¾ç¤ºè€äººæ‰€åœ¨æˆ¿é—´å·

**åç«¯ç°çŠ¶ï¼š** æŠ¤ç†ä»»åŠ¡è¡¨ä¸­æ²¡æœ‰æˆ¿é—´å·å­—æ®µ

**å»ºè®®ï¼š** 
- å¦‚éœ€æ˜¾ç¤ºæˆ¿é—´å·ï¼Œéœ€è¦é€šè¿‡ `elderly_id` æŸ¥è¯¢è€äººä¿¡æ¯ï¼Œå†æŸ¥è¯¢åºŠä½ä¿¡æ¯è·å–æˆ¿é—´å·
- æˆ–è€…æš‚æ—¶ä¸æ˜¾ç¤ºæˆ¿é—´å·

### 4. å¤‡æ³¨å­—æ®µï¼ˆnotesï¼‰
**å‰ç«¯éœ€æ±‚ï¼š** ä»»åŠ¡å¤‡æ³¨

**åç«¯ç°çŠ¶ï¼š** æš‚æ— æ­¤å­—æ®µ

**å»ºè®®ï¼š** 
- å¯ä»¥ä½¿ç”¨ `description` å­—æ®µåŒ…å«å¤‡æ³¨å†…å®¹
- æˆ–è€…æš‚æ—¶ä¸æ”¯æŒå•ç‹¬çš„å¤‡æ³¨åŠŸèƒ½

---

## ğŸ”— è¾…åŠ©æ¥å£

### è·å–æŠ¤å·¥åˆ—è¡¨
```
GET /api/system/users?role=caregiver
```

ç”¨äºä»»åŠ¡åˆ†é…æ—¶çš„æŠ¤å·¥ä¸‹æ‹‰åˆ—è¡¨ã€‚

---

## âœ… æ€»ç»“

### å¿…é¡»è°ƒæ•´çš„å­—æ®µæ˜ å°„
1. âœ… `task_content` â†’ `description`
2. âœ… `caregiver_name` â†’ `assigned_to_name`

### å¯ä»¥å¿½ç•¥çš„å­—æ®µ
1. âš ï¸ `task_type` - å‰ç«¯å¯ç”¨ `title` æ›¿ä»£æˆ–åšæ˜ å°„
2. âš ï¸ `started_at` - åç«¯æš‚ä¸æ”¯æŒ
3. âš ï¸ `room_number` - åç«¯æš‚ä¸æ”¯æŒ
4. âš ï¸ `notes` - åç«¯æš‚ä¸æ”¯æŒï¼ˆå¯ç”¨ `description` åŒ…å«ï¼‰

### æƒé™è¯´æ˜
- **admin/nurse**: å¯ä»¥åˆ›å»ºã€æŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤æ‰€æœ‰ä»»åŠ¡
- **caregiver**: åªèƒ½æŸ¥çœ‹åˆ†é…ç»™è‡ªå·±çš„ä»»åŠ¡ï¼Œå¯ä»¥æ›´æ–°ä»»åŠ¡çŠ¶æ€

---

**æ–‡æ¡£æ›´æ–°æ—¶é—´**: 2026-01-20  
**åç«¯ç‰ˆæœ¬**: v1.0  
**å»ºè®®å‰ç«¯æŒ‰æ­¤æ–‡æ¡£è°ƒæ•´æ¥å£è°ƒç”¨**
